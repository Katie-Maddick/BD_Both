# Imports
import sys
from datetime import datetime, timedelta

# List of flights
Flights = noErr['FlightID'].tolist()

# List of departures
depEpoch = noErr['DepTime'].tolist()

# Convert to GMT
depGMT = []

for time in range(0, len(depEpoch)):
    t = datetime.fromtimestamp(depEpoch[time])
    depGMT.append(t)

# Time of flight
time = noErr['TotalTime'].tolist()

# List of arrivals
arr = []

for times in range(0,len(time)):
    time_change = timedelta(minutes=time[times]) 
    new_time = depGMT[times] + time_change 
    arr.append(new_time)

# Number of passengers
def count_words(Flights):
    counter = Counter()
    for passenger in Flights:
        words = passenger.split()
        counter.update(words)
    return counter

counter = count_words(Flights)

counter_keys = list(counter.keys())
counter_values = list(counter.values())

for i in range(0, len(counter_keys)):
    print('Code: ', counter_keys[i],' Counter: ', counter_values[i],', Departure: ', depGMT[i], ', Arrival: ', arr[i])
